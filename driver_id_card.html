<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Driver ID Card App</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
        }
        
        .header h1 {
            color: #2c3e50;
            font-size: 2.5rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        
        .header p {
            color: #7f8c8d;
            font-size: 1.1rem;
            margin-top: 10px;
        }
        
        .app-container {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }
        
        .form-section, .preview-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .section-title {
            color: #3498db;
            font-size: 1.5rem;
            margin-bottom: 25px;
            padding-bottom: 10px;
            border-bottom: 2px solid #3498db;
        }
        
        /* Photo Upload Section */
        .photo-section {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .photo-container {
            width: 200px;
            height: 200px;
            margin: 0 auto 20px;
            border-radius: 50%;
            border: 3px dashed #3498db;
            position: relative;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .photo-container:hover {
            border-color: #2980b9;
            transform: scale(1.05);
        }
        
        .photo-preview {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: none;
        }
        
        .photo-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: #7f8c8d;
            background: #f8f9fa;
        }
        
        .camera-icon {
            font-size: 48px;
            margin-bottom: 10px;
            color: #3498db;
        }
        
        /* Form Styles */
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #2c3e50;
            font-weight: 600;
        }
        
        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        .form-control:focus {
            outline: none;
            border-color: #3498db;
        }
        
        /* Button Styles */
        .button-group {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
            min-width: 150px;
        }
        
        .btn-primary {
            background: #3498db;
            color: white;
        }
        
        .btn-primary:hover {
            background: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.3);
        }
        
        .btn-secondary {
            background: #2ecc71;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #27ae60;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(46, 204, 113, 0.3);
        }
        
        .btn-outline {
            background: transparent;
            color: #7f8c8d;
            border: 2px solid #bdc3c7;
        }
        
        .btn-outline:hover {
            border-color: #3498db;
            color: #3498db;
        }
        
        /* Card Preview Styles */
        .card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            padding: 25px;
            color: white;
            position: relative;
            max-width: 400px;
            margin: 0 auto;
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
        }
        
        .card-header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(255,255,255,0.2);
        }
        
        .card-company {
            font-size: 22px;
            font-weight: bold;
            margin-bottom: 5px;
            letter-spacing: 1px;
        }
        
        .card-title {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .card-body {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            align-items: center;
        }
        
        .card-photo {
            width: 120px;
            height: 140px;
            border-radius: 8px;
            border: 3px solid white;
            object-fit: cover;
            background: rgba(255,255,255,0.1);
        }
        
        .card-info {
            flex: 1;
        }
        
        .card-field {
            margin-bottom: 15px;
        }
        
        .card-label {
            font-size: 12px;
            opacity: 0.8;
            margin-bottom: 3px;
            text-transform: uppercase;
        }
        
        .card-value {
            font-size: 18px;
            font-weight: 600;
            letter-spacing: 0.5px;
        }
        
        .card-footer {
            border-top: 2px solid rgba(255,255,255,0.2);
            padding-top: 15px;
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
        }
        
        .expiry {
            text-align: center;
        }
        
        .expiry-label {
            font-size: 11px;
            opacity: 0.8;
            margin-bottom: 3px;
        }
        
        .expiry-date {
            font-size: 16px;
            font-weight: bold;
            color: #ffeb3b;
        }
        
        .card-id {
            font-size: 10px;
            opacity: 0.7;
            font-style: italic;
        }
        
        /* Hidden Elements */
        .hidden {
            display: none;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .form-section, .preview-section {
                padding: 20px;
            }
            
            .photo-container {
                width: 150px;
                height: 150px;
            }
            
            .card {
                max-width: 100%;
            }
            
            .card-body {
                flex-direction: column;
                text-align: center;
            }
            
            .button-group {
                flex-direction: column;
            }
        }
        
        /* Date Input Custom */
        input[type="date"] {
            padding: 11px 15px;
        }
        
        /* File Input Hidden */
        #photoInput {
            display: none;
        }
        
        /* Toggle Switch */
        .toggle-container {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .toggle-btn {
            display: inline-flex;
            background: #ecf0f1;
            border-radius: 50px;
            padding: 5px;
            cursor: pointer;
        }
        
        .toggle-option {
            padding: 10px 25px;
            border-radius: 50px;
            transition: all 0.3s;
            font-weight: 600;
        }
        
        .toggle-option.active {
            background: #3498db;
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Driver ID Card Generator</h1>
            <p>Create and manage professional driver identification cards</p>
        </div>
        
        <div class="toggle-container">
            <div class="toggle-btn">
                <div class="toggle-option active" id="editToggle">Edit Card</div>
                <div class="toggle-option" id="previewToggle">Preview Card</div>
            </div>
        </div>
        
        <div class="app-container">
            <!-- Edit Form Section -->
            <div class="form-section" id="editSection">
                <h2 class="section-title">Driver Information</h2>
                
                <div class="photo-section">
                    <div class="photo-container" id="photoContainer">
                        <img id="photoPreview" class="photo-preview" alt="Driver Photo">
                        <div class="photo-placeholder" id="photoPlaceholder">
                            <div class="camera-icon">üì∑</div>
                            <div>Click to upload photo</div>
                            <div style="font-size: 12px; margin-top: 5px;">or use camera</div>
                        </div>
                    </div>
                    <input type="file" id="photoInput" accept="image/*" capture="environment">
                </div>
                
                <form id="driverForm">
                    <div class="form-group">
                        <label for="driverId">Driver ID Number:</label>
                        <input type="text" id="driverId" class="form-control" placeholder="Enter driver ID number" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="driverName">Driver Full Name:</label>
                        <input type="text" id="driverName" class="form-control" placeholder="Enter driver's full name" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="companyName">Company Name:</label>
                        <input type="text" id="companyName" class="form-control" placeholder="Enter company name" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="expirationDate">ID Expiration Date:</label>
                        <input type="date" id="expirationDate" class="form-control" required>
                    </div>
                    
                    <div class="button-group">
                        <button type="button" class="btn btn-primary" id="saveBtn">
                            üíæ Save Card Data
                        </button>
                        <button type="button" class="btn btn-secondary" id="updatePreviewBtn">
                            üëÅÔ∏è Update Preview
                        </button>
                        <button type="button" class="btn btn-outline" id="clearBtn">
                            üóëÔ∏è Clear All
                        </button>
                    </div>
                </form>
            </div>
            
            <!-- Card Preview Section -->
            <div class="preview-section hidden" id="previewSection">
                <h2 class="section-title">ID Card Preview</h2>
                
                <div class="card">
                    <div class="card-header">
                        <div class="card-company" id="previewCompany">COMPANY NAME</div>
                        <div class="card-title">DRIVER IDENTIFICATION CARD</div>
                    </div>
                    
                    <div class="card-body">
                        <img id="previewPhoto" class="card-photo" alt="Driver Photo">
                        <div class="card-info">
                            <div class="card-field">
                                <div class="card-label">Driver ID</div>
                                <div class="card-value" id="previewId">N/A</div>
                            </div>
                            <div class="card-field">
                                <div class="card-label">Full Name</div>
                                <div class="card-value" id="previewName">John Doe</div>
                            </div>
                            <div class="card-field">
                                <div class="card-label">Status</div>
                                <div class="card-value" style="color: #2ecc71;">Active</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card-footer">
                        <div class="expiry">
                            <div class="expiry-label">Expiration Date</div>
                            <div class="expiry-date" id="previewExpiry">2024-12-31</div>
                        </div>
                        <div class="card-id">Valid Driver Identification</div>
                    </div>
                </div>
                
                <div class="button-group" style="margin-top: 30px;">
                    <button type="button" class="btn btn-primary" id="downloadBtn">
                        ‚¨áÔ∏è Download Card Image
                    </button>
                    <button type="button" class="btn btn-outline" id="backBtn">
                        ‚Üê Back to Edit
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Status Messages -->
        <div id="statusMessage" style="margin-top: 20px; text-align: center;"></div>
    </div>

    <script>
        // DOM Elements
        const editSection = document.getElementById('editSection');
        const previewSection = document.getElementById('previewSection');
        const editToggle = document.getElementById('editToggle');
        const previewToggle = document.getElementById('previewToggle');
        const photoContainer = document.getElementById('photoContainer');
        const photoInput = document.getElementById('photoInput');
        const photoPreview = document.getElementById('photoPreview');
        const photoPlaceholder = document.getElementById('photoPlaceholder');
        const saveBtn = document.getElementById('saveBtn');
        const updatePreviewBtn = document.getElementById('updatePreviewBtn');
        const clearBtn = document.getElementById('clearBtn');
        const backBtn = document.getElementById('backBtn');
        const downloadBtn = document.getElementById('downloadBtn');
        const statusMessage = document.getElementById('statusMessage');
        
        // Form fields
        const driverId = document.getElementById('driverId');
        const driverName = document.getElementById('driverName');
        const companyName = document.getElementById('companyName');
        const expirationDate = document.getElementById('expirationDate');
        
        // Preview elements
        const previewPhoto = document.getElementById('previewPhoto');
        const previewId = document.getElementById('previewId');
        const previewName = document.getElementById('previewName');
        const previewCompany = document.getElementById('previewCompany');
        const previewExpiry = document.getElementById('previewExpiry');
        
        // Set default date (6 months from today)
        const defaultDate = new Date();
        defaultDate.setMonth(defaultDate.getMonth() + 6);
        expirationDate.valueAsDate = defaultDate;
        expirationDate.min = new Date().toISOString().split('T')[0];
        
        // Event Listeners
        editToggle.addEventListener('click', () => switchView('edit'));
        previewToggle.addEventListener('click', () => switchView('preview'));
        photoContainer.addEventListener('click', () => photoInput.click());
        photoInput.addEventListener('change', handlePhotoUpload);
        saveBtn.addEventListener('click', saveData);
        updatePreviewBtn.addEventListener('click', updatePreview);
        clearBtn.addEventListener('click', clearAll);
        backBtn.addEventListener('click', () => switchView('edit'));
        downloadBtn.addEventListener('click', downloadCard);
        
        // Load saved data on page load
        window.addEventListener('DOMContentLoaded', loadSavedData);
        
        // View Switching
        function switchView(view) {
            if (view === 'edit') {
                editSection.classList.remove('hidden');
                previewSection.classList.add('hidden');
                editToggle.classList.add('active');
                previewToggle.classList.remove('active');
            } else {
                editSection.classList.add('hidden');
                previewSection.classList.remove('hidden');
                editToggle.classList.remove('active');
                previewToggle.classList.add('active');
                updatePreview(); // Always update preview when switching to preview
            }
        }
        
        // Handle Photo Upload
        function handlePhotoUpload(event) {
            const file = event.target.files[0];
            if (file) {
                if (!file.type.startsWith('image/')) {
                    showStatus('Please upload an image file', 'error');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    photoPreview.src = e.target.result;
                    photoPreview.style.display = 'block';
                    photoPlaceholder.style.display = 'none';
                    previewPhoto.src = e.target.result;
                    
                    // Save photo to localStorage
                    localStorage.setItem('driverPhoto', e.target.result);
                    showStatus('Photo uploaded successfully!', 'success');
                };
                reader.readAsDataURL(file);
            }
        }
        
        // Save Data to localStorage
        function saveData() {
            if (!validateForm()) {
                showStatus('Please fill all required fields', 'error');
                return;
            }
            
            const data = {
                driverId: driverId.value,
                driverName: driverName.value,
                companyName: companyName.value,
                expirationDate: expirationDate.value,
                photo: photoPreview.src || localStorage.getItem('driverPhoto') || ''
            };
            
            localStorage.setItem('driverCardData', JSON.stringify(data));
            showStatus('Card data saved successfully!', 'success');
            updatePreview();
        }
        
        // Load Saved Data
        function loadSavedData() {
            const savedData = localStorage.getItem('driverCardData');
            if (savedData) {
                const data = JSON.parse(savedData);
                
                driverId.value = data.driverId || '';
                driverName.value = data.driverName || '';
                companyName.value = data.companyName || '';
                expirationDate.value = data.expirationDate || expirationDate.value;
                
                if (data.photo) {
                    photoPreview.src = data.photo;
                    photoPreview.style.display = 'block';
                    photoPlaceholder.style.display = 'none';
                    previewPhoto.src = data.photo;
                }
                
                updatePreview();
                showStatus('Previous data loaded successfully!', 'success');
            }
        }
        
        // Update Preview Card
        function updatePreview() {
            previewId.textContent = driverId.value || 'N/A';
            previewName.textContent = driverName.value || 'Full Name';
            previewCompany.textContent = companyName.value.toUpperCase() || 'COMPANY NAME';
            
            // Format date for display
            if (expirationDate.value) {
                const date = new Date(expirationDate.value);
                previewExpiry.textContent = date.toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric'
                });
                
                // Check if expired
                const today = new Date();
                if (date < today) {
                    previewExpiry.style.color = '#e74c3c';
                    previewExpiry.innerHTML += ' <span style="font-size:10px;">(EXPIRED)</span>';
                } else if ((date - today) / (1000 * 60 * 60 * 24) < 30) {
                    previewExpiry.style.color = '#f39c12';
                } else {
                    previewExpiry.style.color = '#2ecc71';
                }
            }
        }
        
        // Clear All Data
        function clearAll() {
            if (confirm('Are you sure you want to clear all data?')) {
                driverId.value = '';
                driverName.value = '';
                companyName.value = '';
                expirationDate.valueAsDate = defaultDate;
                photoPreview.src = '';
                photoPreview.style.display = 'none';
                photoPlaceholder.style.display = 'flex';
                previewPhoto.src = '';
                
                localStorage.removeItem('driverCardData');
                localStorage.removeItem('driverPhoto');
                
                updatePreview();
                showStatus('All data cleared successfully!', 'success');
            }
        }
        
        // Download Card as Image
        function downloadCard() {
            // In a real app, you would use html2canvas library
            // For this demo, we'll provide a simple download link for the photo
            if (photoPreview.src && photoPreview.src.startsWith('data:')) {
                const link = document.createElement('a');
                link.download = `Driver_ID_${driverId.value || 'Card'}.png`;
                link.href = photoPreview.src;
                link.click();
                showStatus('Photo downloaded! For full card, use html2canvas library.', 'info');
            } else {
                showStatus('Please upload a photo first to download', 'error');
            }
        }
        
        // Form Validation
        function validateForm() {
            return driverId.value.trim() !== '' && 
                   driverName.value.trim() !== '' && 
                   companyName.value.trim() !== '' && 
                   expirationDate.value !== '';
        }
        
        // Show Status Messages
        function showStatus(message, type) {
            statusMessage.textContent = message;
            statusMessage.style.color = type === 'error' ? '#e74c3c' : 
                                       type === 'success' ? '#2ecc71' : 
                                       type === 'info' ? '#3498db' : '#7f8c8d';
            statusMessage.style.fontWeight = '600';
            statusMessage.style.padding = '10px';
            statusMessage.style.borderRadius = '5px';
            statusMessage.style.backgroundColor = type === 'error' ? '#fadbd8' : 
                                                 type === 'success' ? '#d5f4e6' : 
                                                 type === 'info' ? '#d6eaf8' : '#f8f9fa';
            
            setTimeout(() => {
                statusMessage.textContent = '';
                statusMessage.style.backgroundColor = 'transparent';
            }, 3000);
        }
        
        // Mobile Camera Access
        function requestCamera() {
            if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
                navigator.mediaDevices.getUserMedia({ video: true })
                    .then(function(stream) {
                        // In a real app, you would show video and capture image
                        showStatus('Camera access granted! Use the upload button to take photo.', 'info');
                        stream.getTracks().forEach(track => track.stop());
                    })
                    .catch(function(error) {
                        showStatus('Camera access denied: ' + error.message, 'error');
                    });
            } else {
                showStatus('Camera not supported on this device/browser', 'error');
            }
        }
        
        // Check for mobile device
        function isMobile() {
            return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        }
        
        // Initialize mobile-specific features
        if (isMobile()) {
            photoInput.setAttribute('capture', 'environment');
            photoPlaceholder.querySelector('div:nth-child(3)').textContent = 'Tap to use camera';
        }
        
        // Export data function (useful for sharing)
        function exportData() {
            const data = {
                driverId: driverId.value,
                driverName: driverName.value,
                companyName: companyName.value,
                expirationDate: expirationDate.value
            };
            
            const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(data, null, 2));
            const link = document.createElement('a');
            link.download = `driver_card_${driverId.value || 'data'}.json`;
            link.href = dataStr;
            link.click();
        }
        
        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            // Ctrl+S to save
            if (e.ctrlKey && e.key === 's') {
                e.preventDefault();
                saveData();
            }
            // Esc to go back
            if (e.key === 'Escape' && !previewSection.classList.contains('hidden')) {
                switchView('edit');
            }
        });
        
        // Show welcome message
        setTimeout(() => {
            showStatus('Welcome! Fill in the form to create your driver ID card.', 'info');
        }, 1000);
    </script>
</body>
</html>
